<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="incidence2">
<title>Handling incidence objects • incidence2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Handling incidence objects">
<meta property="og:description" content="incidence2">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">incidence2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.9.9.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/incidence2.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/handling_incidence_objects.html">Handling incidence objects</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/reconverse/incidence2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Handling incidence objects</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/reconverse/incidence2/blob/HEAD/vignettes/handling_incidence_objects.Rmd" class="external-link"><code>vignettes/handling_incidence_objects.Rmd</code></a></small>
      <div class="d-none name"><code>handling_incidence_objects.Rmd</code></div>
    </div>

    
    
<p><code><a href="../reference/incidence.html">incidence()</a></code> objects are easy to work with, and we
providing helper functions for both manipulating and accessing the
underlying data and attributes.</p>
<div class="section level2">
<h2 id="modifying-incidence-objects">Modifying incidence objects<a class="anchor" aria-label="anchor" href="#modifying-incidence-objects"></a>
</h2>
<div class="section level3">
<h3 id="regroup">
<code>regroup()</code><a class="anchor" aria-label="anchor" href="#regroup"></a>
</h3>
<p>Sometimes you may find you’ve created a grouped incidence but now
want to change the internal grouping. Assuming you are after a subset of
the grouping already generated, then you can use to
<code><a href="../reference/regroup.html">regroup()</a></code> function to get the desired aggregation:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/reconhub/outbreaks" class="external-link">outbreaks</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/reconverse/incidence2" class="external-link">incidence2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.reconverse.org/grates/" class="external-link">grates</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load data</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">ebola_sim_clean</span><span class="op">$</span><span class="va">linelist</span></span>
<span></span>
<span><span class="co"># convert date_of_onset to isoweeks</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">date_of_onset</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://www.reconverse.org/grates/reference/as_isoweek.html" class="external-link">as_isoweek</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">date_of_onset</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate the incidence object with 3 groups</span></span>
<span><span class="op">(</span><span class="va">inci</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/incidence.html">incidence</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">"date_of_onset"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"hospital"</span>, <span class="st">"outcome"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 1,448 x 6</span></span></span>
<span><span class="co">#&gt;    date_index gender hospital                              outcome count…¹ count</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                                 <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2014-W15   f      Military Hospital                     <span style="color: #BB0000;">NA</span>      date_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2014-W16   m      Connaught Hospital                    <span style="color: #BB0000;">NA</span>      date_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2014-W17   f      <span style="color: #BB0000;">NA</span>                                    <span style="color: #BB0000;">NA</span>      date_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2014-W17   f      <span style="color: #BB0000;">NA</span>                                    Death   date_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2014-W17   f      other                                 Recover date_o…     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2014-W17   m      other                                 Recover date_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2014-W18   f      <span style="color: #BB0000;">NA</span>                                    Recover date_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2014-W18   f      Connaught Hospital                    Recover date_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2014-W18   f      Princess Christian Maternity Hospita… Death   date_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2014-W18   f      Rokupa Hospital                       Recover date_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 1,438 more rows, and abbreviated variable name ¹​count_variable</span></span></span>
<span></span>
<span><span class="co"># regroup to just two groups</span></span>
<span><span class="fu"><a href="../reference/regroup.html">regroup</a></span><span class="op">(</span><span class="va">inci</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"outcome"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 320 x 5</span></span></span>
<span><span class="co">#&gt;    date_index gender outcome count_variable count</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2014-W15   f      <span style="color: #BB0000;">NA</span>      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2014-W16   m      <span style="color: #BB0000;">NA</span>      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2014-W17   f      <span style="color: #BB0000;">NA</span>      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2014-W17   f      Death   date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2014-W17   f      Recover date_of_onset      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2014-W17   m      Recover date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2014-W18   f      Death   date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2014-W18   f      Recover date_of_onset      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2014-W19   f      <span style="color: #BB0000;">NA</span>      date_of_onset      4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2014-W19   f      Death   date_of_onset      2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 310 more rows</span></span></span>
<span></span>
<span><span class="co"># drop all groups</span></span>
<span><span class="fu"><a href="../reference/regroup.html">regroup</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 56 x 3</span></span></span>
<span><span class="co">#&gt;    date_index count_variable count</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2014-W15   date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2014-W16   date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2014-W17   date_of_onset      5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2014-W18   date_of_onset      4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2014-W19   date_of_onset     12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2014-W20   date_of_onset     17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2014-W21   date_of_onset     15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2014-W22   date_of_onset     19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2014-W23   date_of_onset     23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2014-W24   date_of_onset     21</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 46 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cumulate">cumulate<a class="anchor" aria-label="anchor" href="#cumulate"></a>
</h3>
<p>We also provide a helper function, <code>cumulate</code>() to easily
generate cumulative incidences:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regroup.html">regroup</a></span><span class="op">(</span><span class="va">inci</span>, <span class="st">"hospital"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cumulate.html">cumulate</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="handling_incidence_objects_files/figure-html/cumulate-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="keep_first-and-keep_last">
<code>keep_first()</code> and <code>keep_last()</code><a class="anchor" aria-label="anchor" href="#keep_first-and-keep_last"></a>
</h3>
<p>Once your data is grouped by date, you may want to select the first
or last few entries based on a particular date grouping using
<code><a href="../reference/keep.html">keep_first()</a></code> and <code><a href="../reference/keep.html">keep_last()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/keep.html">keep_first</a></span><span class="op">(</span><span class="va">inci</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 108 x 6</span></span></span>
<span><span class="co">#&gt;    date_index gender hospital           outcome count_variable count</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2014-W15   f      <span style="color: #BB0000;">NA</span>                 <span style="color: #BB0000;">NA</span>      date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2014-W16   f      <span style="color: #BB0000;">NA</span>                 <span style="color: #BB0000;">NA</span>      date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2014-W17   f      <span style="color: #BB0000;">NA</span>                 <span style="color: #BB0000;">NA</span>      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2014-W15   f      <span style="color: #BB0000;">NA</span>                 Death   date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2014-W16   f      <span style="color: #BB0000;">NA</span>                 Death   date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2014-W17   f      <span style="color: #BB0000;">NA</span>                 Death   date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2014-W15   f      <span style="color: #BB0000;">NA</span>                 Recover date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2014-W16   f      <span style="color: #BB0000;">NA</span>                 Recover date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2014-W17   f      <span style="color: #BB0000;">NA</span>                 Recover date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2014-W15   f      Connaught Hospital <span style="color: #BB0000;">NA</span>      date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 98 more rows</span></span></span>
<span><span class="fu"><a href="../reference/keep.html">keep_last</a></span><span class="op">(</span><span class="va">inci</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 108 x 6</span></span></span>
<span><span class="co">#&gt;    date_index gender hospital           outcome count_variable count</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2015-W16   f      <span style="color: #BB0000;">NA</span>                 <span style="color: #BB0000;">NA</span>      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2015-W17   f      <span style="color: #BB0000;">NA</span>                 <span style="color: #BB0000;">NA</span>      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2015-W18   f      <span style="color: #BB0000;">NA</span>                 <span style="color: #BB0000;">NA</span>      date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2015-W16   f      <span style="color: #BB0000;">NA</span>                 Death   date_of_onset      7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2015-W17   f      <span style="color: #BB0000;">NA</span>                 Death   date_of_onset      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2015-W18   f      <span style="color: #BB0000;">NA</span>                 Death   date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2015-W16   f      <span style="color: #BB0000;">NA</span>                 Recover date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2015-W17   f      <span style="color: #BB0000;">NA</span>                 Recover date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2015-W18   f      <span style="color: #BB0000;">NA</span>                 Recover date_of_onset      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2015-W16   f      Connaught Hospital <span style="color: #BB0000;">NA</span>      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 98 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subsetting-and-other-manipulations">subsetting and other manipulations<a class="anchor" aria-label="anchor" href="#subsetting-and-other-manipulations"></a>
</h3>
<p><code>&lt;incidence&gt;</code> objects have been carefully
constructed to preserve their structure under a range of different
operations that can be applied to data frames. By this we mean that if
an operation is applied to an <code>&lt;incidence&gt;</code> object then
as long as the invariants of the object are preserved (i.e. groups,
interval and uniqueness of rows) then the object retain it’s incidence
class. If the invariants are not preserved then a
<code>&lt;data frame&gt;</code> will be returned instead.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inci</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regroup.html">regroup</a></span><span class="op">(</span><span class="va">inci</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hospital"</span>, <span class="st">"gender"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># filtering preserves class</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">inci</span>, <span class="va">gender</span> <span class="op">==</span> <span class="st">"f"</span> <span class="op">&amp;</span> <span class="va">hospital</span> <span class="op">==</span> <span class="st">"Rokupa Hospital"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 48 x 5</span></span></span>
<span><span class="co">#&gt;    date_index hospital        gender count_variable count</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2014-W18   Rokupa Hospital f      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2014-W20   Rokupa Hospital f      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2014-W22   Rokupa Hospital f      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2014-W23   Rokupa Hospital f      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2014-W25   Rokupa Hospital f      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2014-W27   Rokupa Hospital f      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2014-W28   Rokupa Hospital f      date_of_onset      4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2014-W29   Rokupa Hospital f      date_of_onset      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2014-W30   Rokupa Hospital f      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2014-W31   Rokupa Hospital f      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 38 more rows</span></span></span>
<span><span class="va">inci</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 3 x 5</span></span></span>
<span><span class="co">#&gt;   date_index hospital          gender count_variable count</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2014-W15   Military Hospital f      date_of_onset      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2014-W17   <span style="color: #BB0000;">NA</span>                f      date_of_onset      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2014-W17   other             m      date_of_onset      1</span></span>
<span></span>
<span><span class="co"># Adding columns preserve class</span></span>
<span><span class="va">inci</span><span class="op">$</span><span class="va">future</span> <span class="op">&lt;-</span> <span class="va">inci</span><span class="op">$</span><span class="va">date_index</span> <span class="op">+</span> <span class="fl">999L</span></span>
<span><span class="va">inci</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 601 x 6</span></span></span>
<span><span class="co">#&gt;    date_index hospital                               gender count…¹ count future</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                                  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;isow&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2014-W15   Military Hospital                      f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2014-W16   Connaught Hospital                     m      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2014-W17   <span style="color: #BB0000;">NA</span>                                     f      date_o…     2 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2014-W17   other                                  f      date_o…     2 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2014-W17   other                                  m      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2014-W18   <span style="color: #BB0000;">NA</span>                                     f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2014-W18   Connaught Hospital                     f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2014-W18   Princess Christian Maternity Hospital… f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2014-W18   Rokupa Hospital                        f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2014-W19   <span style="color: #BB0000;">NA</span>                                     f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 591 more rows, and abbreviated variable name ¹​count_variable</span></span></span>
<span></span>
<span><span class="co"># rename preserve class</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span> <span class="op">==</span> <span class="st">"date_index"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"isoweek"</span></span>
<span><span class="va">inci</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 601 x 6</span></span></span>
<span><span class="co">#&gt;    isoweek  hospital                                 gender count…¹ count future</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                                    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;isow&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2014-W15 Military Hospital                        f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2014-W16 Connaught Hospital                       m      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2014-W17 <span style="color: #BB0000;">NA</span>                                       f      date_o…     2 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2014-W17 other                                    f      date_o…     2 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2014-W17 other                                    m      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2014-W18 <span style="color: #BB0000;">NA</span>                                       f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2014-W18 Connaught Hospital                       f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2014-W18 Princess Christian Maternity Hospital (… f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2014-W18 Rokupa Hospital                          f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2014-W19 <span style="color: #BB0000;">NA</span>                                       f      date_o…     1 2033-…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 591 more rows, and abbreviated variable name ¹​count_variable</span></span></span>
<span></span>
<span><span class="co"># select returns a data frame unless all date, count and group variables are</span></span>
<span><span class="co"># preserved in the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">inci</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1L</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    601 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;  $ hospital      : Factor w/ 5 levels "Connaught Hospital",..: 2 1 NA 3 3 NA 1 4 5 NA ...</span></span>
<span><span class="co">#&gt;  $ gender        : Factor w/ 2 levels "f","m": 1 2 1 1 2 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ count_variable: chr  "date_of_onset" "date_of_onset" "date_of_onset" "date_of_onset" ...</span></span>
<span><span class="co">#&gt;  $ count         : int  1 1 2 2 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ future        : 'grates_isoweek' int  2033-W22 2033-W23 2033-W24 2033-W24 2033-W24 2033-W25 2033-W25 2033-W25 2033-W25 2033-W26 ...</span></span>
<span><span class="va">inci</span><span class="op">[</span>, <span class="op">-</span><span class="fl">6L</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># incidence: 601 x 5</span></span></span>
<span><span class="co">#&gt;    isoweek  hospital                                     gender count_va…¹ count</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;isowk&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                                        <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2014-W15 Military Hospital                            f      date_of_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2014-W16 Connaught Hospital                           m      date_of_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2014-W17 <span style="color: #BB0000;">NA</span>                                           f      date_of_o…     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2014-W17 other                                        f      date_of_o…     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2014-W17 other                                        m      date_of_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2014-W18 <span style="color: #BB0000;">NA</span>                                           f      date_of_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2014-W18 Connaught Hospital                           f      date_of_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2014-W18 Princess Christian Maternity Hospital (PCMH) f      date_of_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2014-W18 Rokupa Hospital                              f      date_of_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2014-W19 <span style="color: #BB0000;">NA</span>                                           f      date_of_o…     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 591 more rows, and abbreviated variable name ¹​count_variable</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="accessing-variable-information">Accessing variable information<a class="anchor" aria-label="anchor" href="#accessing-variable-information"></a>
</h2>
<p>We provide multiple accessors to easily access information about an
<code>&lt;incidence&gt;</code> object’s structure:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the name of the date_index variable of x</span></span>
<span><span class="fu"><a href="../reference/accessors.html">get_date_index_name</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "isoweek"</span></span>
<span></span>
<span><span class="co"># alias for `get_date_index_name()`</span></span>
<span><span class="fu"><a href="../reference/accessors.html">get_dates_name</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "isoweek"</span></span>
<span></span>
<span><span class="co"># the name of the count variable of x</span></span>
<span><span class="fu"><a href="../reference/accessors.html">get_count_variable_name</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "count_variable"</span></span>
<span></span>
<span><span class="co"># the name of the count value of x</span></span>
<span><span class="fu"><a href="../reference/accessors.html">get_count_value_name</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "count"</span></span>
<span></span>
<span><span class="co"># the name(s) of the group variable(s) of x</span></span>
<span><span class="fu"><a href="../reference/accessors.html">get_group_names</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "hospital" "gender"</span></span>
<span></span>
<span><span class="co"># list containing date_index variable of x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/accessors.html">get_date_index</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ isoweek: 'grates_isoweek' int [1:601] 2014-W15 2014-W16 2014-W17 2014-W17 2014-W17 2014-W18 2014-W18 2014-W18 2014-W18 2014-W19 ...</span></span>
<span></span>
<span><span class="co"># alias for get_date_index</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/accessors.html">get_dates</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ isoweek: 'grates_isoweek' int [1:601] 2014-W15 2014-W16 2014-W17 2014-W17 2014-W17 2014-W18 2014-W18 2014-W18 2014-W18 2014-W19 ...</span></span>
<span></span>
<span><span class="co"># list containing the count variable of x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/accessors.html">get_count_variable</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ count_variable: chr [1:601] "date_of_onset" "date_of_onset" "date_of_onset" "date_of_onset" ...</span></span>
<span></span>
<span><span class="co"># list containing count value of x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/accessors.html">get_count_value</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ count: int [1:601] 1 1 2 2 1 1 1 1 1 1 ...</span></span>
<span></span>
<span><span class="co"># list of the group variable(s) of x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/accessors.html">get_groups</a></span><span class="op">(</span><span class="va">inci</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ hospital: Factor w/ 5 levels "Connaught Hospital",..: 2 1 NA 3 3 NA 1 4 5 NA ...</span></span>
<span><span class="co">#&gt;  $ gender  : Factor w/ 2 levels "f","m": 1 2 1 1 2 1 1 1 1 1 ...</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tim Taylor.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
